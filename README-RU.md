# Бот для тестовой сети Huddle01

Бот на основе Python, предназначенный для автоматизации участия в комнатах тестовой сети Huddle01 с использованием нескольких учетных записей. Бот управляет аутентификацией, управлением сессиями, обменом данными через WebSocket и предназначен для поддержания присутствия в указанной комнате Huddle01.

## Функции

* **Поддержка нескольких учетных записей:** Загружайте несколько приватных ключей Ethereum, чтобы присоединиться к комнате с разными участниками.
* **Автоматическое присоединение к комнате:** Автоматически управляет процессом присоединения к комнате Huddle01.
* **Аутентификация кошелька:** Реализует механизм подписи "вызов-ответ" для входа в Huddle01.
* **Управление сессиями:** Сохраняет отображаемые имена и пользовательские агенты для учетных записей между сессиями (`session.json`).
* **Случайные пользовательские агенты:** Генерирует случайные, но правдоподобные пользовательские агенты для каждой учетной записи.
* **Связь через WebSocket:** Устанавливает и управляет соединениями WebSocket для взаимодействия внутри комнаты.
* **Корректное завершение работы:** Обрабатывает `SIGINT` (Ctrl+C) и `SIGTERM` для чистого завершения работы.
* **Мониторинг соединения и автопереподключение:** Отслеживает активные соединения и пытается переподключиться, если сессия прерывается.
* **Настраиваемое использование учетных записей:** Укажите количество учетных записей для использования или используйте все доступные из `private_key.txt`.
* **Динамический ввод идентификатора комнаты:** Принимает идентификатор комнаты напрямую или извлекает его из полного URL комнаты Huddle01.
* **Участие в тестовой сети:** Включает функциональность, направленную на взаимодействие с функциями, специфичными для тестовой сети (например, сбор очков).

## Предварительные требования

* Python 3.8 или выше
* `pip` (установщик пакетов Python)

## Настройка и установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/rasputingrigori/huddle01-testnet.git
    cd huddle01-testnet
    ```

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv venv
    ```
    ### В Windows
    ```bash
    venv\Scripts\activate
    ```
    ### В macOS/Linux
    ```bash
    source venv/bin/activate
    ```

4.  **Установите зависимости:**

    Убедитесь, что ваш `requirements.txt` выглядит следующим образом, прежде чем устанавливать:
    ```txt
    aiohttp==3.9.5
    websockets==12.0
    eth-account==0.12.0
    Faker==25.8.0
    colorama==0.4.6
    brotli==1.1.0
    ```
    Затем установите:
    ```bash
    pip install -r requirements.txt
    ```

## Конфигурация

1.  **`private_key.txt`:**
    * Создайте файл с именем `private_key.txt` в корневой директории проекта (на том же уровне, что и `main.py`).
    * Добавьте свои приватные ключи Ethereum в этот файл, по одному приватному ключу на строку.
    * Ключи могут быть с префиксом `0x` или без него.
    * Пример:
        ```
        0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
        fedcba0987654321fedcba0987654321fedcba0987654321fedcba0987654321
        ```

2.  **`session.json`:**
    * Этот файл будет автоматически создан и обновлен `account_manager.py` при первом запуске бота с новыми приватными ключами.
    * Он хранит сгенерированные отображаемые имена и пользовательские агенты, связанные с каждым приватным ключом, для поддержания согласованности между сессиями. Обычно вам не нужно редактировать этот файл вручную.

3.  **`config.py`:**
    * Этот файл содержит конечные точки API и `NEXTJS_BUILD_ID`.
    * `NEXTJS_BUILD_ID`: Этот ID используется для получения определенных данных комнаты. Если Huddle01 обновит свой интерфейс, этот ID может измениться, что потенциально может вызвать ошибки, когда бот пытается получить метаданные комнаты. Если вы столкнетесь с такими проблемами, вам может потребоваться найти и обновить это значение, проверив сетевые запросы на веб-сайте Huddle01.

## Использование

Запустите скрипт `main.py` из корневой директории проекта.

**Базовый синтаксис:**
```bash
python main.py [room_id_or_url] [-n num_accounts]
```

### Аргументы:
`room_id_or_url (необязательно):`
Идентификатор комнаты Huddle01 (например, abc-defg-hij).
Или полный URL комнаты Huddle01 (например, https://huddle01.app/room/abc-defg-hij).
Если не указан, скрипт предложит вам ввести его.

`-n num_accounts, --num_accounts num_accounts (необязательно):` Количество учетных записей для использования из `private_key.txt.`
Если 0 (по умолчанию) или не указано, будут использоваться все доступные учетные записи из `private_key.txt.` Если указано положительное число, будет загружено это количество учетных записей.

Если доступных учетных записей меньше, чем запрошено, будет показано предупреждение, и будут использованы все доступные учетные записи.
Отрицательное число будет рассматриваться как запрос на использование всех учетных записей.

### Примеры:
Присоединиться к комнате по ее ID со всеми учетными записями:

```bash
python main.py abc-defg-hij
```
Присоединиться к комнате по ее URL с первыми 5 учетными записями из private_key.txt:
```bash
python main.py https://huddle01.app/room/abc-defg-hij -n 5
```
Запуск без аргументов (попросит ввести ID комнаты):

```bash
python main.py
```
Бот затем спросит: `Enter the Huddle01 room ID to join:`

Бот будет регистрировать свои действия в консоли, включая информацию о подключениях учетных записей, ошибках и событиях WebSocket. Нажмите Ctrl+C для инициирования корректного завершения работы.

## Обзор структуры файлов
```yaml
├── main.py                    # Главная точка входа для бота
├── requirements.txt           # Зависимости пакетов Python
├── config.py                  # Конфигурация для конечных точек API, ID сборки
├── src/
│   ├── helpers/
│   │   ├── account_manager.py # Управляет приватными ключами и данными сессий
│   │   ├── api_client.py      # Обрабатывает HTTP API взаимодействия с Huddle01
│   │   ├── main_controller.py # Оркеструет экземпляры бота и подключения
│   │   └── websocket_handler.py # Управляет подключениями и сообщениями WebSocket
│   └── utils/
│       ├── utils.py           # Вспомогательные функции (логирование, генерация UA)
│       └── banner.py          # Для отображения стартового баннера
├── private_key.txt            # (Создается пользователем) Хранит приватные ключи
└── session.json               # (Автоматически генерируется) Хранит детали сессий учетных записей
```

## Зависимости
Ключевые зависимости перечислены в requirements.txt и включают:

- `aiohttp`: Для асинхронных HTTP-запросов.
- `websockets`: Для связи через WebSocket.
- `eth-account`: Для обработки учетных записей Ethereum и подписей.
- `Faker`: Для генерации случайных отображаемых имен.
- `colorama`: Для цветного вывода в консоль.
- `brotli`: Для сжатия данных.

## Внесение вклада
Приветствуются любые вклады! Пожалуйста, не стесняйтесь отправлять запросы на извлечение (pull request) или открывать проблемы (issue) для любых ошибок, функций или улучшений.

## Отказ от ответственности

* Этот бот предназначен для образовательных и тестовых целей, в частности для взаимодействия со средой тестовой сети Huddle01.
* Пользователи несут единоличную ответственность за то, чтобы использование этого бота соответствовало условиям обслуживания Huddle01 и любым применимым политикам платформы.
* Разработчики этого проекта не несут ответственности за любое неправомерное использование, ограничения учетных записей или другие последствия, возникающие в результате использования этого бота.

## Лицензия
Лицензия MIT отсутствует, "This project is unlicensed."